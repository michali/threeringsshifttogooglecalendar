<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Add To Calendar Tests</title>

    <link rel="stylesheet" href="qunit/qunit-1.15.0.css" />
    <script src="qunit/qunit-1.15.0.js"></script>
	<script src="../js/datePrototypeExtensions.js"></script>
    <script src="../js/googleCalendarEvent.js"></script>
	<script src="../js/addToCalendar.js"></script>
    <script>
		var ShiftMock = function(containerWithShiftDateTimeInfoId) {
			this.containerWithShiftDateTimeInfoId = containerWithShiftDateTimeInfoId;
		};
		
		var StorageMock = function(){
			this.get = function(data, action){
				var items = {eventSubject:''}; 
				action(items);
			}
		}
		
		function contains(largerString, substring){
			return largerString.href.indexOf(substring) > -1;
		}
		
		test("AddToCalendar.WhenShiftRollsByMidnight.ShouldAddEndDateNextDay", function (assert) {
			var shift = new ShiftMock("week_view_rota_shift_period_day_23_00_01_00_2014_10_31");
			var calendarLink = createAddToGoogleCalendarLink(shift, new StorageMock());
			assert.ok(contains(calendarLink, "dates=20141031T230000Z%2F20141101T010000Z"));
		});
		
		test("AddToCalendar.WhenShiftIsOnSameDay.EndDayShouldBeSameAsStartDay", function (assert) {
			var shift = new ShiftMock("week_view_rota_shift_period_day_21_00_23_00_2014_10_31");
			var calendarLink = createAddToGoogleCalendarLink(shift, new StorageMock());
			assert.ok(contains(calendarLink, "dates=20141031T210000Z%2F20141031T230000Z"));
		});
    </script>
</head>
<body>
    <div id="qunit"></div>
</body>
</html>